<app-agent-sidebar></app-agent-sidebar>
<app-agent-top-menu></app-agent-top-menu>

<div class="content">


  <div class="content-wrapper">    <div class="row">
      <!-- Left section -->
      <div style="display: flex;">
        <h2><strong>Ticket</strong></h2>
        <!-- <button class="backButton" onclick="window.history.back()">Back</button>
        <button class="closeButton" (click)="navigateToDestination()">Close</button> -->
      </div>
      <hr>
      <div class="col-8">
        
        <!-- Main card -->
        <div class="card" style="width: 100%;">
          <div class="card-body">
            <!-- Top section inside main card -->
            <div style="display: flex; margin-bottom: 20px;">
              <h3><strong>{{dataArray.category}}</strong></h3>
              <div style="display: flex; margin-left: auto;">
                <p class="form-header badge badge-secondary" id="ticketID">{{ticketId}}</p>
                <p class="form-header badge badge-danger" id="priorityID">{{dataArray.priority}}</p>
                <p class="form-header badge badge-success" id="statusID">{{dataArray.status}}</p>
              </div>
            </div>
            <!-- <hr/> -->
            <div *ngFor="let msg of messageList | async">
              <!-- Displaying the message sender and timestamp -->
              <p>{{ msg.sender }} <span class="form-header">Today, 11:30 PM</span></p>
              
              <!-- Displaying the message content conditionally -->
              <div *ngIf="msg.sender === accountId; else elseBlock">
                <div class="replied">
                  <span style="color: #202020;">{{ msg.content }}</span>
                </div>
              </div>
              
              <!-- Template for messages not sent by the current user -->
              <ng-template #elseBlock>
                <div class="replied">
                  <span style="color: #202020;">{{ msg.content }}</span>
                </div>
              </ng-template>
            </div>
            <!-- <p>John <span class="form-header">Today, 11:30 PM</span></p> -->
            <!-- Message input section -->
            <div class="message-input">
              <input type="text"
              [(ngModel)]="newMessage" placeholder="Write your response for the issue" class="text-class"/>
              <div style="display: flex; margin-top: 20px;">
                <div>
                  <!-- Hidden file input -->
                  <input type="file" #fileInput style="display: none;" (change)="onFileSelected($event)"/>
                </div>
                <button type="button" class="attachButton" type="file" (click)="fileInput.click()">
                  <img src="../../../assets/images/Vector (Stroke).svg" width="17px" height="17px" style="margin-right: 15px;"/>
                  Attach
                </button>
                <button (click)="sendMessage()" class="nextButton">Send</button>
              </div>
            </div>
          </div>
        </div>
        <button class="closeButton" routerLink="agent-tickets">Back</button>

        <!-- Bottom section card -->
        
      </div>
      <!-- Right section card -->
      <div class="col">
        <div class="card" style="width: 100%;">
          <div class="card-body">
            <!-- Ticket info -->
            <div class="row">
              <h6>Ticket Info</h6>

              <div class="col">
              <p class="form-header">Ticket Id: <span id="ticketID" class="form-header badge badge-secondary">{{ticketId}}</span></p>
              <p class="form-header">Created : <span>{{dataArray.createdAt}}</span></p>
              <p class="form-header">Status: <span class="form-header badge badge-success" id="statusID">{{dataArray.status}}</span></p>
              <p class="form-header">Priority: <span class="form-header badge badge-danger" id="priorityID">{{dataArray.priority}}</span></p>
            </div>
            
              <hr/>
            </div>
          </div>
        </div>
        <div class="card" style="width: 100%;margin-top:10px;">
          <div class="card-body">
            <p>Close Ticket</p>
            <textarea placeholder="Type reason here"></textarea>
            <button class="closeButton">Close</button>
          
          </div>
        </div>

        <div class="card" style="width: 100%;margin-top:10px;">
          <div class="card-body">
            <p>Escalate Ticket</p>
            <input placeholder="Name" class="escalate-input">
            <textarea placeholder="Type reason here"></textarea>
            <button class="escalate-button">Escalate</button>
          
          </div>
        </div>
      </div>

    </div>

  </div>

</div>
